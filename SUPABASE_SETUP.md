# Configuração do Supabase

Para que o sistema funcione corretamente com sincronização em nuvem, você precisa criar as tabelas no seu projeto do Supabase.

Execute os comandos SQL abaixo no Editor SQL do seu painel do Supabase.

## 1. Tabela `events`

Armazena os eventos do calendário (Férias, Feriados, etc).

```sql
create table public.events (
  id uuid not null primary key,
  user_email text not null,
  title text not null,
  start_date text not null,
  end_date text not null,
  type text not null,
  description text,
  color text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- Habilitar Row Level Security (RLS)
alter table public.events enable row level security;

-- Política de acesso (simplificada para demonstração - idealmente usar auth.uid())
create policy "Enable all access for users based on email"
on public.events
for all
using (true)
with check (true);
```

## 2. Tabela `days`

Armazena a definição de guarda (Pai/Mãe) e detalhes do dia.

```sql
create table public.days (
  id bigint generated by default as identity primary key,
  user_email text not null,
  date text not null,
  parent text not null,
  pickup_time text, -- Novo: Horário de busca (ex: "18:00")
  dropoff_time text, -- Novo: Horário de entrega (ex: "09:00")
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- Adicionar constraint única para garantir apenas um registro por dia por usuário
alter table public.days add constraint unique_day_per_user unique (user_email, date);

-- Habilitar Row Level Security (RLS)
alter table public.days enable row level security;

-- Política de acesso
create policy "Enable all access for users based on email"
on public.days
for all
using (true)
with check (true);
```

## 3. Atualização (Migration) para Tabela `days` Existente

Se você já criou a tabela `days` anteriormente, execute este comando para adicionar as novas colunas:

```sql
-- Adicionar colunas de horário se não existirem
alter table public.days add column if not exists pickup_time text;
alter table public.days add column if not exists dropoff_time text;

-- Adicionar constraint única se não existir (necessário remover duplicatas antes se houver)
-- alter table public.days add constraint unique_day_per_user unique (user_email, date);
```

## 4. Configuração no Projeto

Certifique-se de que suas variáveis de ambiente em `.env` estão configuradas:

```env
VITE_SUPABASE_URL=sua_url_do_supabase
VITE_SUPABASE_ANON_KEY=sua_chave_anonima
```
